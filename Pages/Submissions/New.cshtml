@page "{TaskId}"
@model pro_web.Pages.Submissions.NewModel
@{
    var C_BASE = "#include <stdio.h>\n\nint main()\n{\n\treturn 0;\n}";
}
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>소스코드 - 프로</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="~/lib/@@fortawesome/fontawesome-free/css/all.min.css">
    <link rel="stylesheet" href="~/lib/codemirror/lib/codemirror.css">
    <link rel="stylesheet" href="~/lib/codemirror/theme/mdn-like.css">
    <style>
        .CodeMirror {
            font-family: SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;
            font-size: 1rem;
            height: auto;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand navbar-dark bg-dark">
        <div class="container">
            <a asp-page="/Index" class="navbar-brand">소스코드</a>
            <ul class="navbar-nav mr-auto">
                <li class="nav-item">
                    <a asp-page="./Index" class="nav-link">
                        검색
                    </a>
                </li>
            </ul>
            <form class="form-inline" action="<?=$router->pathFor('logout')?>" method="post">
                <button type="submit" class="btn btn-link text-muted" title="로그아웃"><i class="fas fa-sign-out-alt"></i></button>
            </form>
        </div>
    </nav>
    <div class="container mt-1 mb-3">
        <nav class="nav nav-pills nav-justify">
            <a asp-page="/Tasks/Read" asp-route-taskId="@Model.TaskId"
               class="nav-item nav-link">
                문제
            </a>
            <a asp-page="/Submissions/New" asp-route-taskId="@Model.TaskId"
               class="nav-item nav-link active">
                제출
            </a>
            <a asp-page="/Submissions/Index" asp-route-taskId="@Model.TaskId"
               class="nav-item nav-link">
                채점 현황
            </a>
        </nav>
    </div>
    <div class="container">
        <h3 class="mb-3">@Model.Task.Title</h3>
        <form id="submit" method="post">
            <div class="form-group">
                <label for="language">
                    언어
                </label>
                <select id="language" class="form-control">
                    <option>C (MSVC 14)</option>
                </select>
            </div>
            <div class="form-group">
                <label for="source">
                    코드
                </label>
                <textarea id="source" name="source" class="form-control text-monospace" wrap="off" rows="20" style="tab-size:4;">@C_BASE</textarea>
            </div>
            <div class="form-group">
                <button type="submit" class="btn btn-primary btn-block">제출하기</button>
            </div>
        </form>
    </div>
    <script src="~/lib/codemirror/lib/codemirror.js"></script>
    <script src="~/lib/codemirror/mode/clike/clike.js"></script>
    <script src="~/lib/codemirror/addon/edit/matchbrackets.js"></script>
    <script src="~/lib/codemirror/addon/edit/closebrackets.js"></script>
    <script>
        var code = CodeMirror.fromTextArea(document.getElementById('source'), {
            indentUnit: 4,
            mode: 'text/x-csrc',
            lineNumbers: true,
            viewportMargin: Infinity,
            theme: 'mdn-like',
            matchBrackets: true,
            autoCloseBrackets: true,
            indentWithTabs: true,
        });
        code.on('change', function () {
            code.save();
        });
        // var saveTimer;
        // $('textarea').on('input propertychange', function(e) {
        //     clearTimeout(saveTimer);
        //     saveTimer = setTimeout(function() {
        //             // localStorage['pro_submit'] = $('textarea').val();
        //             localStorage['pro_submit'] = code.getValue();
        //         }, 1000);
        // });
        // if (localStorage['pro_submit'])
        // {
        //     // $('textarea').val(localStorage['pro_submit']);
        //     code.setValue(localStorage['pro_submit']);
        // }
    </script>
</body>
</html>
